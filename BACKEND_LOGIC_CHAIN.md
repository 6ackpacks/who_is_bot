# Who-is-the-Bot åç«¯é€»è¾‘é“¾æ¡å®Œæ•´æ–‡æ¡£

## ğŸ“Š ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¾®ä¿¡å°ç¨‹åº  â”‚
â”‚   å‰ç«¯      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ wx.cloud.callContainer
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å¾®ä¿¡äº‘æ‰˜ç®¡ (NestJS)        â”‚
â”‚   who-is-the-bot-api2       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ TypeORM
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   è…¾è®¯äº‘ MySQL æ•°æ®åº“        â”‚
â”‚   sh-cynosdbmysql-grp-...   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—„ï¸ æ•°æ®åº“è¡¨ç»“æ„

### 1. users è¡¨ï¼ˆç”¨æˆ·ä¿¡æ¯ï¼‰
```sql
users {
  id: UUID (ä¸»é”®)
  nickname: VARCHAR(100)          -- æ˜µç§°
  uid: VARCHAR(50) UNIQUE         -- å¾®ä¿¡å”¯ä¸€æ ‡è¯†
  level: INT DEFAULT 1            -- ç­‰çº§ (1-4)
  avatar: TEXT                    -- å¤´åƒURL

  -- ç»Ÿè®¡å­—æ®µ
  totalJudged: INT DEFAULT 0      -- æ€»åˆ¤å®šæ•°
  correctCount: INT DEFAULT 0     -- æ€»æ­£ç¡®æ•°
  accuracy: FLOAT DEFAULT 0       -- å‡†ç¡®ç‡ (%)
  streak: INT DEFAULT 0           -- å½“å‰è¿èƒœ
  maxStreak: INT DEFAULT 0        -- æœ€å¤§è¿èƒœ

  -- å‘¨ç»Ÿè®¡
  weeklyJudged: INT DEFAULT 0     -- å‘¨åˆ¤å®šæ•°
  weeklyCorrect: INT DEFAULT 0    -- å‘¨æ­£ç¡®æ•°
  weeklyAccuracy: FLOAT DEFAULT 0 -- å‘¨å‡†ç¡®ç‡
  lastWeekReset: TIMESTAMP        -- ä¸Šæ¬¡å‘¨é‡ç½®æ—¶é—´

  createdAt: TIMESTAMP
  updatedAt: TIMESTAMP
}
```

### 2. content è¡¨ï¼ˆå†…å®¹ï¼‰
```sql
content {
  id: VARCHAR(36) (ä¸»é”®)
  type: VARCHAR(20)               -- 'text', 'image', 'video'
  url: TEXT                       -- å†…å®¹URL
  text: TEXT                      -- æ–‡æœ¬å†…å®¹
  title: VARCHAR(255)             -- æ ‡é¢˜
  isAi: BOOLEAN                   -- æ˜¯å¦æ˜¯AIç”Ÿæˆ
  modelTag: VARCHAR(100)          -- æ¨¡å‹æ ‡ç­¾
  provider: VARCHAR(100)          -- æä¾›è€…
  deceptionRate: FLOAT            -- æ¬ºéª—ç‡
  explanation: TEXT               -- è§£é‡Šè¯´æ˜

  -- æŠ•ç¥¨ç»Ÿè®¡
  totalVotes: INT DEFAULT 0       -- æ€»æŠ•ç¥¨æ•°
  aiVotes: INT DEFAULT 0          -- è®¤ä¸ºæ˜¯AIçš„æŠ•ç¥¨æ•°
  humanVotes: INT DEFAULT 0       -- è®¤ä¸ºæ˜¯äººç±»çš„æŠ•ç¥¨æ•°
  correctVotes: INT DEFAULT 0     -- æ­£ç¡®æŠ•ç¥¨æ•°

  createdAt: TIMESTAMP
  updatedAt: TIMESTAMP
}
```

### 3. judgments è¡¨ï¼ˆåˆ¤å®šè®°å½•ï¼‰
```sql
judgments {
  id: UUID (ä¸»é”®)
  userId: UUID (å¤–é”® â†’ users.id)  -- ç”¨æˆ·IDï¼ˆå¯ä¸ºç©ºï¼Œæ¸¸å®¢æ¨¡å¼ï¼‰
  contentId: VARCHAR(36) (å¤–é”® â†’ content.id)  -- å†…å®¹ID
  userChoice: VARCHAR(10)         -- 'ai' æˆ– 'human'
  isCorrect: BOOLEAN              -- æ˜¯å¦æ­£ç¡®
  guestId: VARCHAR(50)            -- æ¸¸å®¢IDï¼ˆå¦‚æœæœªç™»å½•ï¼‰
  createdAt: TIMESTAMP

  -- ç´¢å¼•
  INDEX idx_user_id (userId)
  INDEX idx_content_id (contentId)
  INDEX idx_created_at (createdAt)
}
```

---

## ğŸ”„ æ ¸å¿ƒä¸šåŠ¡æµç¨‹

### æµç¨‹1ï¼šç”¨æˆ·åˆ¤å®šå†…å®¹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ç”¨æˆ·åœ¨å‰ç«¯ç‚¹å‡»"è¯¥æ˜¯äººæœº"æˆ–"åŒ…çœŸäººçš„"                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. å‰ç«¯è°ƒç”¨ api.submitJudgment()                            â”‚
â”‚    - contentId: å†…å®¹ID                                       â”‚
â”‚    - userChoice: 'ai' æˆ– 'human'                            â”‚
â”‚    - isCorrect: å‰ç«¯è®¡ç®—æ˜¯å¦æ­£ç¡®                             â”‚
â”‚    - userId: ç”¨æˆ·IDï¼ˆç™»å½•ç”¨æˆ·ï¼‰æˆ– guestIdï¼ˆæ¸¸å®¢ï¼‰            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. åç«¯ POST /judgment/submit                               â”‚
â”‚    JudgmentService.submitJudgment()                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. ä¿å­˜åˆ¤å®šè®°å½•åˆ° judgments è¡¨                               â”‚
â”‚    INSERT INTO judgments (                                  â”‚
â”‚      userId, contentId, userChoice, isCorrect, createdAt    â”‚
â”‚    ) VALUES (?, ?, ?, ?, NOW())                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. æ›´æ–° content è¡¨çš„æŠ•ç¥¨ç»Ÿè®¡                                 â”‚
â”‚    UPDATE content SET                                       â”‚
â”‚      totalVotes = totalVotes + 1,                          â”‚
â”‚      aiVotes = aiVotes + (userChoice == 'ai' ? 1 : 0),    â”‚
â”‚      humanVotes = humanVotes + (userChoice == 'human' ? 1:0)â”‚
â”‚      correctVotes = correctVotes + (isCorrect ? 1 : 0)     â”‚
â”‚    WHERE id = contentId                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. æ›´æ–° users è¡¨çš„ç»Ÿè®¡æ•°æ®ï¼ˆä»…ç™»å½•ç”¨æˆ·ï¼‰                      â”‚
â”‚    UPDATE users SET                                         â”‚
â”‚      totalJudged = totalJudged + 1,                        â”‚
â”‚      correctCount = correctCount + (isCorrect ? 1 : 0),    â”‚
â”‚      accuracy = (correctCount / totalJudged) * 100,        â”‚
â”‚      streak = isCorrect ? streak + 1 : 0,                  â”‚
â”‚      maxStreak = MAX(maxStreak, streak),                   â”‚
â”‚      weeklyJudged = weeklyJudged + 1,                      â”‚
â”‚      weeklyCorrect = weeklyCorrect + (isCorrect ? 1 : 0),  â”‚
â”‚      weeklyAccuracy = (weeklyCorrect/weeklyJudged) * 100   â”‚
â”‚    WHERE id = userId                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. è¿”å›æˆåŠŸå“åº”                                              â”‚
â”‚    { success: true, message: "åˆ¤å®šå·²è®°å½•" }                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æµç¨‹2ï¼šæŸ¥çœ‹ä¸ªäººç»Ÿè®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ç”¨æˆ·æ‰“å¼€"æˆ‘çš„"é¡µé¢                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. å‰ç«¯è°ƒç”¨ api.getUserStats(userId)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. åç«¯ GET /user/:id/stats                                 â”‚
â”‚    UserController.getUserStats()                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. æŸ¥è¯¢ users è¡¨                                             â”‚
â”‚    SELECT * FROM users WHERE id = userId                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. è¿”å›ç»Ÿè®¡æ•°æ®                                              â”‚
â”‚    {                                                        â”‚
â”‚      success: true,                                         â”‚
â”‚      data: {                                                â”‚
â”‚        totalJudged: 850,                                    â”‚
â”‚        accuracy: 89.4,                                      â”‚
â”‚        correctCount: 760,                                   â”‚
â”‚        streak: 12,                                          â”‚
â”‚        maxStreak: 45,                                       â”‚
â”‚        weeklyAccuracy: 92.3,                                â”‚
â”‚        weeklyJudged: 130,                                   â”‚
â”‚        level: 3,                                            â”‚
â”‚        levelName: "äººæœºæ€æ‰‹"                                 â”‚
â”‚      }                                                      â”‚
â”‚    }                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æµç¨‹3ï¼šæŸ¥çœ‹æ’è¡Œæ¦œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ç”¨æˆ·æ‰“å¼€æ’è¡Œæ¦œé¡µé¢                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. å‰ç«¯è°ƒç”¨ api.getLeaderboard()                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. åç«¯ GET /leaderboard?limit=50&type=weekly              â”‚
â”‚    LeaderboardController.getLeaderboard()                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. æŸ¥è¯¢ users è¡¨ï¼ˆæŒ‰åˆ¤å®šæ•°æ’åºï¼‰                             â”‚
â”‚    SELECT * FROM users                                      â”‚
â”‚    ORDER BY totalJudged DESC, accuracy DESC                 â”‚
â”‚    LIMIT 50                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. æ ¼å¼åŒ–æ•°æ®å¹¶è¿”å›                                          â”‚
â”‚    {                                                        â”‚
â”‚      success: true,                                         â”‚
â”‚      data: [                                                â”‚
â”‚        {                                                    â”‚
â”‚          id: "user-id",                                     â”‚
â”‚          username: "Sherlock_H",                            â”‚
â”‚          avatar: "https://...",                             â”‚
â”‚          level: "ç¡…è°·å¤©æ‰",                                  â”‚
â”‚          bustedCount: 1240,                                 â”‚
â”‚          maxStreak: 45,                                     â”‚
â”‚          weeklyAccuracy: 98.5                               â”‚
â”‚        },                                                   â”‚
â”‚        ...                                                  â”‚
â”‚      ]                                                      â”‚
â”‚    }                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¡ API æ¥å£æ¸…å•

### åˆ¤å®šç›¸å…³
| æ–¹æ³• | è·¯å¾„ | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|------|
| POST | `/judgment/submit` | æäº¤åˆ¤å®šç»“æœ | âœ… å·²å®ç° |
| GET | `/judgment/user/:userId` | è·å–ç”¨æˆ·åˆ¤å®šå†å² | âœ… å·²å®ç° |
| GET | `/judgment/content/:contentId` | è·å–å†…å®¹åˆ¤å®šå†å² | âœ… å·²å®ç° |

### ç”¨æˆ·ç›¸å…³
| æ–¹æ³• | è·¯å¾„ | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|------|
| GET | `/user/:id` | è·å–ç”¨æˆ·å®Œæ•´ä¿¡æ¯ | âœ… å·²å®ç° |
| GET | `/user/:id/stats` | è·å–ç”¨æˆ·ç»Ÿè®¡æ•°æ® | âœ… å·²å®ç° |
| GET | `/user/uid/:uid` | é€šè¿‡å¾®ä¿¡UIDè·å–ç”¨æˆ· | âœ… å·²å®ç° |
| POST | `/user` | åˆ›å»ºæ–°ç”¨æˆ· | âœ… å·²å®ç° |

### æ’è¡Œæ¦œç›¸å…³
| æ–¹æ³• | è·¯å¾„ | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|------|
| GET | `/leaderboard` | è·å–æ’è¡Œæ¦œ | âœ… å·²å®ç° |

### å†…å®¹ç›¸å…³
| æ–¹æ³• | è·¯å¾„ | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|------|
| GET | `/content/feed` | è·å–å†…å®¹åˆ—è¡¨ | âœ… å·²å®ç° |
| GET | `/content/:id` | è·å–å•ä¸ªå†…å®¹ | âœ… å·²å®ç° |
| POST | `/content` | åˆ›å»ºæ–°å†…å®¹ | âœ… å·²å®ç° |

---

## ğŸ¯ å½“å‰åŠŸèƒ½çŠ¶æ€

### âœ… å·²å®ç°
1. **åˆ¤å®šç³»ç»Ÿ**
   - è®°å½•æ¯æ¬¡åˆ¤å®šåˆ°æ•°æ®åº“
   - è‡ªåŠ¨æ›´æ–°ç”¨æˆ·ç»Ÿè®¡ï¼ˆå‡†ç¡®ç‡ã€è¿èƒœç­‰ï¼‰
   - è‡ªåŠ¨æ›´æ–°å†…å®¹ç»Ÿè®¡ï¼ˆæŠ•ç¥¨æ•°ã€æ­£ç¡®ç‡ï¼‰
   - æ”¯æŒæ¸¸å®¢æ¨¡å¼åˆ¤å®š

2. **ä¸ªäººç»Ÿè®¡**
   - å®æ—¶æ˜¾ç¤ºæ€»åˆ¤å®šæ•°
   - å®æ—¶æ˜¾ç¤ºå‡†ç¡®ç‡
   - å®æ—¶æ˜¾ç¤ºè¿èƒœè®°å½•
   - å‘¨ç»Ÿè®¡æ•°æ®

3. **æ’è¡Œæ¦œ**
   - æŒ‰æ€»åˆ¤å®šæ•°æ’åº
   - æ˜¾ç¤ºç”¨æˆ·ç­‰çº§
   - æ˜¾ç¤ºå‘¨å‡†ç¡®ç‡

4. **å†…å®¹ç®¡ç†**
   - è·å–å†…å®¹åˆ—è¡¨
   - è¿½è¸ªæ¯ä¸ªå†…å®¹çš„æŠ•ç¥¨ç»Ÿè®¡
   - è¿½è¸ªæ¯ä¸ªå†…å®¹çš„æ­£ç¡®ç‡

### â³ å¾…å®ç°

1. **æ’è¡Œæ¦œä¼˜åŒ–**
   - [ ] 24å°æ—¶å®šæ—¶åˆ·æ–°æœºåˆ¶
   - [ ] æ’è¡Œæ¦œç¼“å­˜ï¼ˆRedisï¼‰
   - [ ] åˆ†é¡µåŠ è½½

2. **ç”¨æˆ·ç³»ç»Ÿ**
   - [ ] è‡ªåŠ¨ç­‰çº§å‡çº§é€»è¾‘
   - [ ] ç­‰çº§å‡çº§é€šçŸ¥
   - [ ] ç”¨æˆ·æˆå°±ç³»ç»Ÿ

3. **ç»Ÿè®¡ä¼˜åŒ–**
   - [ ] å‘¨ç»Ÿè®¡è‡ªåŠ¨é‡ç½®ï¼ˆå®šæ—¶ä»»åŠ¡ï¼‰
   - [ ] å†å²æ•°æ®å½’æ¡£
   - [ ] æ•°æ®åˆ†ææŠ¥è¡¨

4. **æ€§èƒ½ä¼˜åŒ–**
   - [ ] æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–
   - [ ] æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–
   - [ ] æ‰¹é‡æ›´æ–°ä¼˜åŒ–

5. **é˜²åˆ·æœºåˆ¶**
   - [ ] é™åˆ¶åŒä¸€ç”¨æˆ·å¯¹åŒä¸€å†…å®¹çš„é‡å¤åˆ¤å®š
   - [ ] åˆ¤å®šé¢‘ç‡é™åˆ¶
   - [ ] å¼‚å¸¸è¡Œä¸ºæ£€æµ‹

---

## ğŸš€ å¼€å‘æ–¹å‘å»ºè®®

### ä¼˜å…ˆçº§1ï¼šæ ¸å¿ƒåŠŸèƒ½å®Œå–„ï¼ˆå½“å‰é˜¶æ®µï¼‰
1. **æµ‹è¯•å½“å‰åŠŸèƒ½**
   - éªŒè¯åˆ¤å®šè®°å½•æ˜¯å¦æ­£å¸¸
   - éªŒè¯ä¸ªäººç»Ÿè®¡æ˜¯å¦å®æ—¶æ›´æ–°
   - éªŒè¯æ’è¡Œæ¦œæ•°æ®æ˜¯å¦æ­£ç¡®

2. **ä¿®å¤å·²çŸ¥é—®é¢˜**
   - ç¡®ä¿äº‘æ‰˜ç®¡éƒ¨ç½²æˆåŠŸ
   - ç¡®ä¿æ•°æ®åº“è¿æ¥ç¨³å®š
   - ç¡®ä¿APIå“åº”æ­£å¸¸

### ä¼˜å…ˆçº§2ï¼šç”¨æˆ·ä½“éªŒä¼˜åŒ–
1. **ç­‰çº§ç³»ç»Ÿ**
   ```typescript
   // è‡ªåŠ¨å‡çº§é€»è¾‘
   function checkLevelUp(user: User): boolean {
     const levelThresholds = [
       { level: 1, minJudged: 0, minAccuracy: 0 },      // AIå°ç™½
       { level: 2, minJudged: 100, minAccuracy: 70 },   // èƒœä¼¼äººæœº
       { level: 3, minJudged: 500, minAccuracy: 80 },   // äººæœºæ€æ‰‹
       { level: 4, minJudged: 1000, minAccuracy: 90 },  // ç¡…è°·å¤©æ‰
     ];

     for (let i = levelThresholds.length - 1; i >= 0; i--) {
       const threshold = levelThresholds[i];
       if (user.totalJudged >= threshold.minJudged &&
           user.accuracy >= threshold.minAccuracy) {
         return user.level !== threshold.level;
       }
     }
     return false;
   }
   ```

2. **æˆå°±ç³»ç»Ÿ**
   - é¦–æ¬¡åˆ¤å®š
   - è¿èƒœ10æ¬¡
   - å‡†ç¡®ç‡è¾¾åˆ°90%
   - åˆ¤å®š100æ¬¡
   - ç­‰ç­‰...

### ä¼˜å…ˆçº§3ï¼šæ€§èƒ½ä¼˜åŒ–
1. **æ’è¡Œæ¦œç¼“å­˜**
   ```typescript
   // ä½¿ç”¨Redisç¼“å­˜æ’è¡Œæ¦œ
   @Injectable()
   export class LeaderboardService {
     async getLeaderboard(): Promise<User[]> {
       // 1. å…ˆä»Redisè·å–
       const cached = await redis.get('leaderboard:daily');
       if (cached) return JSON.parse(cached);

       // 2. ä»æ•°æ®åº“æŸ¥è¯¢
       const users = await this.userRepository.find({
         order: { totalJudged: 'DESC' },
         take: 50
       });

       // 3. ç¼“å­˜1å°æ—¶
       await redis.setex('leaderboard:daily', 3600, JSON.stringify(users));

       return users;
     }
   }
   ```

2. **å®šæ—¶ä»»åŠ¡**
   ```typescript
   // æ¯å¤©0ç‚¹é‡ç½®å‘¨ç»Ÿè®¡
   @Cron('0 0 * * 1') // æ¯å‘¨ä¸€0ç‚¹
   async resetWeeklyStats() {
     await this.userRepository.update({}, {
       weeklyJudged: 0,
       weeklyCorrect: 0,
       weeklyAccuracy: 0,
       lastWeekReset: new Date()
     });
   }
   ```

### ä¼˜å…ˆçº§4ï¼šæ•°æ®åˆ†æ
1. **ç»Ÿè®¡æŠ¥è¡¨**
   - æ¯æ—¥æ´»è·ƒç”¨æˆ·
   - å†…å®¹éš¾åº¦åˆ†æ
   - ç”¨æˆ·è¡Œä¸ºåˆ†æ

2. **æ•°æ®å¯è§†åŒ–**
   - åˆ¤å®šè¶‹åŠ¿å›¾
   - å‡†ç¡®ç‡åˆ†å¸ƒ
   - çƒ­é—¨å†…å®¹æ’è¡Œ

---

## ğŸ“ˆ æ•°æ®æµå‘å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç”¨æˆ·åˆ¤å®š    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  POST /judgment/submit                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1. ä¿å­˜åˆ° judgments è¡¨              â”‚  â”‚
â”‚  â”‚ 2. æ›´æ–° content è¡¨æŠ•ç¥¨ç»Ÿè®¡          â”‚  â”‚
â”‚  â”‚ 3. æ›´æ–° users è¡¨ç»Ÿè®¡æ•°æ®            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â†“                 â†“                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ judgments   â”‚  â”‚  content    â”‚  â”‚   users     â”‚
â”‚  è¡¨æ›´æ–°     â”‚  â”‚   è¡¨æ›´æ–°    â”‚  â”‚   è¡¨æ›´æ–°    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                 â”‚                 â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  å‰ç«¯æŸ¥è¯¢                        â”‚
       â”‚  - GET /user/:id/stats          â”‚
       â”‚  - GET /leaderboard             â”‚
       â”‚  - GET /content/:id             â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” å®‰å…¨è€ƒè™‘

1. **é˜²åˆ·æœºåˆ¶**
   - é™åˆ¶åŒä¸€ç”¨æˆ·å¯¹åŒä¸€å†…å®¹åªèƒ½åˆ¤å®šä¸€æ¬¡
   - é™åˆ¶åˆ¤å®šé¢‘ç‡ï¼ˆå¦‚æ¯ç§’æœ€å¤š1æ¬¡ï¼‰

2. **æ•°æ®éªŒè¯**
   - éªŒè¯ contentId æ˜¯å¦å­˜åœ¨
   - éªŒè¯ userId æ˜¯å¦æœ‰æ•ˆ
   - éªŒè¯ userChoice åªèƒ½æ˜¯ 'ai' æˆ– 'human'

3. **æƒé™æ§åˆ¶**
   - æ¸¸å®¢åªèƒ½åˆ¤å®šï¼Œä¸èƒ½ä¿®æ”¹æ•°æ®
   - ç™»å½•ç”¨æˆ·æ‰èƒ½æŸ¥çœ‹ä¸ªäººç»Ÿè®¡

---

## ğŸ“ æ€»ç»“

**å½“å‰ç³»ç»Ÿå·²ç»å…·å¤‡ï¼š**
- âœ… å®Œæ•´çš„åˆ¤å®šè®°å½•åŠŸèƒ½
- âœ… å®æ—¶ç»Ÿè®¡æ›´æ–°
- âœ… ä¸ªäººæ•°æ®æŸ¥è¯¢
- âœ… æ’è¡Œæ¦œå±•ç¤º

**ä¸‹ä¸€æ­¥å»ºè®®ï¼š**
1. **ç«‹å³æµ‹è¯•** - éªŒè¯æ‰€æœ‰åŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œ
2. **æ·»åŠ ç­‰çº§ç³»ç»Ÿ** - è‡ªåŠ¨å‡çº§ç”¨æˆ·ç­‰çº§
3. **ä¼˜åŒ–æ€§èƒ½** - æ·»åŠ ç¼“å­˜å’Œå®šæ—¶ä»»åŠ¡
4. **å®Œå–„ä½“éªŒ** - æ·»åŠ æˆå°±ç³»ç»Ÿå’Œæ•°æ®åˆ†æ

**æŠ€æœ¯å€ºåŠ¡ï¼š**
- éœ€è¦æ·»åŠ å•å…ƒæµ‹è¯•
- éœ€è¦æ·»åŠ APIæ–‡æ¡£
- éœ€è¦æ·»åŠ é”™è¯¯ç›‘æ§
- éœ€è¦ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½

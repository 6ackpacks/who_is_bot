<!--pages/profile/profile.wxml - Redesigned Profile Page-->
<view class="profile-container theme-{{currentTheme}}">
  <scroll-view scroll-y class="profile-scroll">

    <!-- 顶部更多按钮 -->
    <view class="top-bar">
      <view class="more-btn" bindtap="showMoreMenu">
        <antd-icon type="ellipsis" size="md" custom-class="icon-burgundy"></antd-icon>
      </view>
    </view>

    <!-- Avatar Section -->
    <view class="avatar-section">
      <view class="avatar-wrapper">
        <view class="avatar-ring">
          <image src="{{userInfo.avatar}}" class="avatar-image" mode="aspectFill"></image>
        </view>
        <!-- Level Badge Overlay -->
        <view class="level-badge">
          <text class="level-text">Lv.{{userInfo.level}}</text>
        </view>
      </view>

      <!-- Username -->
      <view class="username">{{userInfo.nickname}}</view>

      <!-- Progress Bar -->
      <view class="progress-container">
        <view class="progress-bar">
          <view class="progress-fill" style="width: 66%"></view>
        </view>
        <text class="exp-text">距下一级还需 {{userInfo.remaining}} EXP</text>
      </view>
    </view>

    <!-- Stats Grid -->
    <view class="stats-grid">
      <view class="stat-card">
        <view class="stat-number stat-total">{{stats.totalJudged}}</view>
        <view class="stat-label">总判定</view>
      </view>
      <view class="stat-card">
        <view class="stat-number stat-accuracy">{{stats.accuracy}}%</view>
        <view class="stat-label">准确率</view>
      </view>
      <view class="stat-card">
        <view class="stat-number stat-streak">{{stats.streak}}</view>
        <view class="stat-label">连胜</view>
      </view>
    </view>

    <!-- Action Buttons Grid -->
    <view class="action-buttons-container">
      <view class="action-buttons-grid">
        <view class="action-btn" bindtap="scrollToAchievements">
          <view class="action-icon-circle">
            <antd-icon type="trophy" size="md" custom-class="icon-burgundy"></antd-icon>
          </view>
          <text class="action-label">成就</text>
        </view>
        <view class="action-btn" bindtap="goToLeaderboard">
          <view class="action-icon-circle">
            <antd-icon type="bar-chart" size="md" custom-class="icon-burgundy"></antd-icon>
          </view>
          <text class="action-label">数据</text>
        </view>
        <view class="action-btn" bindtap="handleShare">
          <view class="action-icon-circle">
            <antd-icon type="idcard" size="md" custom-class="icon-burgundy"></antd-icon>
          </view>
          <text class="action-label">名片</text>
        </view>
        <view class="action-btn" bindtap="showMoreMenu">
          <view class="action-icon-circle">
            <antd-icon type="setting" size="md" custom-class="icon-burgundy"></antd-icon>
          </view>
          <text class="action-label">设置</text>
        </view>
      </view>
    </view>

    <!-- Recent Activity Section -->
    <view class="recent-activity-section">
      <view class="section-header">近期判定</view>

      <view class="activity-list">
        <!-- Success Activity Card -->
        <view class="activity-card">
          <image src="https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=100" class="activity-thumbnail" mode="aspectFill"></image>
          <view class="activity-content">
            <view class="activity-title">迷雾中的少女</view>
            <view class="activity-timestamp">2分钟前 • 图片</view>
          </view>
          <view class="activity-status">
            <antd-icon type="check-circle" size="md" custom-class="icon-success"></antd-icon>
            <text class="status-text">成功</text>
          </view>
        </view>

        <!-- Failed Activity Card -->
        <view class="activity-card activity-failed">
          <image src="https://images.unsplash.com/photo-1511367461989-f85a21fda167?q=80&w=100" class="activity-thumbnail" mode="aspectFill"></image>
          <view class="activity-content">
            <view class="activity-title">赛博朋克街道</view>
            <view class="activity-timestamp">15分钟前 • 视频</view>
          </view>
          <view class="activity-status">
            <antd-icon type="close-circle" size="md" custom-class="icon-error"></antd-icon>
            <text class="status-text">失败</text>
          </view>
        </view>

        <!-- Another Success Card -->
        <view class="activity-card">
          <image src="https://images.unsplash.com/photo-1534528741775-53994a69daeb?q=80&w=100" class="activity-thumbnail" mode="aspectFill"></image>
          <view class="activity-content">
            <view class="activity-title">城市夜景</view>
            <view class="activity-timestamp">1小时前 • 图片</view>
          </view>
          <view class="activity-status">
            <antd-icon type="check-circle" size="md" custom-class="icon-success"></antd-icon>
            <text class="status-text">成功</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 退出登录按钮 -->
    <view wx:if="{{isLoggedIn}}" class="logout-section">
      <button class="logout-btn" bindtap="handleLogout">
        <text class="logout-text">退出登录</text>
      </button>
    </view>

    <!-- 底部占位 -->
    <view class="bottom-spacer"></view>

  </scroll-view>

  <!-- 更多菜单弹窗 -->
  <view wx:if="{{showMore}}" class="more-overlay" bindtap="hideMoreMenu">
    <view class="more-menu" catchtap="stopPropagation">
      <view class="more-header">
        <text class="more-title">更多功能</text>
        <view class="more-close" bindtap="hideMoreMenu">
          <antd-icon type="close" size="sm" custom-class="icon-burgundy"></antd-icon>
        </view>
      </view>
      <view class="more-items">
        <view class="more-item" bindtap="handleThemeToggle">
          <view class="more-item-icon">
            <antd-icon type="{{currentTheme === 'dark' ? 'moon' : 'sun'}}" size="lg" custom-class="icon-burgundy"></antd-icon>
          </view>
          <view class="more-item-content">
            <text class="more-item-title">{{currentTheme === 'dark' ? '暗色模式' : '亮色模式'}}</text>
            <text class="more-item-desc">切换到{{currentTheme === 'dark' ? '亮色' : '暗色'}}主题</text>
          </view>
        </view>
        <view class="more-item" bindtap="goToSettings">
          <view class="more-item-icon">
            <antd-icon type="setting" size="lg" custom-class="icon-burgundy"></antd-icon>
          </view>
          <view class="more-item-content">
            <text class="more-item-title">设置</text>
            <text class="more-item-desc">个性化设置</text>
          </view>
        </view>
        <view class="more-item" bindtap="goToAbout">
          <view class="more-item-icon">
            <antd-icon type="info-circle" size="lg" custom-class="icon-burgundy"></antd-icon>
          </view>
          <view class="more-item-content">
            <text class="more-item-title">关于</text>
            <text class="more-item-desc">版本信息</text>
          </view>
        </view>
      </view>
    </view>
  </view>

</view>

<!--pages/leaderboard/leaderboard.wxml - Immersive Redesign-->
<view class="leaderboard-container theme-{{currentTheme}}">

  <!-- 网格背景层 -->
  <view class="grid-background"></view>

  <!-- 沉浸式大卡片页眉 -->
  <view class="immersive-header" style="transform: translateY({{scrollY * 0.3}}rpx);">
    <view class="header-gradient"></view>

    <view class="header-content">
      <view class="header-title">
        <text class="title-text">全网最强</text>
        <text class="title-highlight">赛博侦探榜</text>
      </view>
      <text class="header-subtitle">每周实时更新排行 · 寻找人类最强鹰眼</text>

      <!-- 当前用户排名标签 -->
      <view class="user-rank-badge">
        <text class="rank-badge-text">当前排名：Lv.{{currentUserLevel}} | No.{{currentUserRank}}</text>
      </view>
    </view>
  </view>

  <!-- 加载状态 -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-spinner"></view>
    <text class="loading-text">加载排行榜中...</text>
  </view>

  <!-- 错误状态 -->
  <view wx:elif="{{error}}" class="error-container">
    <text class="error-text">{{error}}</text>
    <button class="retry-btn" bindtap="handleRetry">重新加载</button>
  </view>

  <!-- 排行榜列表 - 无Tab，直接展示 -->
  <scroll-view wx:else scroll-y class="leaderboard-list" bindscroll="handleScroll">
    <view wx:for="{{users}}" wx:key="id" class="user-item rank-{{index + 1}}">

      <!-- 排名数字 -->
      <view class="rank-section">
        <text wx:if="{{index === 0}}" class="rank-medal gold">1</text>
        <text wx:elif="{{index === 1}}" class="rank-medal silver">2</text>
        <text wx:elif="{{index === 2}}" class="rank-medal bronze">3</text>
        <text wx:else class="rank-number">{{index + 1}}</text>
      </view>

      <!-- 头像 -->
      <image src="{{item.avatar}}" class="user-avatar"></image>

      <!-- 用户信息 -->
      <view class="user-info">
        <text class="user-name">{{item.username}}</text>
        <view class="user-meta">
          <view class="level-badge badge-{{item.levelClass}}">
            <text class="badge-text">{{item.level}}</text>
          </view>
        </view>
      </view>

      <!-- 统计数据 - 等宽数字字体 -->
      <view class="user-stats">
        <view class="stat-item">
          <text class="stat-label">周准确率</text>
          <text class="stat-value monospace">{{item.weeklyAccuracy}}%</text>
        </view>
        <view class="stat-item">
          <text class="stat-label">总题目</text>
          <text class="stat-value monospace">{{item.totalJudged}}</text>
        </view>
      </view>

    </view>

    <!-- 底部占位 -->
    <view class="bottom-spacer"></view>
  </scroll-view>

</view>
